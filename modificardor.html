<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <title>Panel de Control - IMPYWEB</title>
    <link rel="stylesheet" href="css/styles.css">
    <style>
        body { font-family: sans-serif; padding: 20px; }
        .item-admin { border: 1px solid #ccc; padding: 15px; margin-bottom: 10px; border-radius: 8px; display: flex; justify-content: space-between; align-items: center; }
        input { width: 60px; padding: 5px; text-align: center; }
        .btn-update { background: #28a745; color: white; border: none; padding: 8px 12px; border-radius: 4px; cursor: pointer; }
    </style>
</head>
<body>
    <h1>Gesti√≥n de Inventario (Admin)</h1>
    <div id="lista-admin"></div>

    <script>
        const API_URL = "http://127.0.0.1:5000";

        async function cargarInventario() {
            const res = await fetch(`${API_URL}/productos`);
            const productos = await res.json();
            const contenedor = document.getElementById("lista-admin");
            contenedor.innerHTML = "";

            productos.forEach(p => {
                const div = document.createElement("div");
                div.className = "item-admin";
                div.innerHTML = `
                    <div>
                        <strong>${p.name}</strong> (ID: ${p.id})
                    </div>
                    <div>
                        Stock: <input type="number" id="stock-${p.id}" value="${p.stock}">
                        <button class="btn-update" onclick="actualizar(${p.id})">Guardar</button>
                    </div>
                `;
                contenedor.appendChild(div);
            });
        }

        async function actualizar(id) {
            const nuevoStock = document.getElementById(`stock-${id}`).value;
            const res = await fetch(`${API_URL}/actualizar-stock`, {
                method: "POST",
                headers: {"Content-Type": "application/json"},
                body: JSON.stringify({ id: id, stock: parseInt(nuevoStock) })
            });
            
            if (res.ok) {
                alert("Inventario actualizado");
                cargarInventario();
            }
        }

        document.addEventListener("DOMContentLoaded", cargarInventario);
    </script>
</body>
</html>